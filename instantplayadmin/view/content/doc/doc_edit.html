<!--<link href="http://{CONST|STATIC_URL}/assets/global/css/xiaEditor-1.1.0-min.css" rel="stylesheet" type="text/css"/>-->
<link href="{CONST|H_STATIC_URL}assets/global/plugins/umeditor/src1/src2/themes/default/css/umeditor.css" rel="stylesheet" type="text/css"/>


<style type="text/css">
	#txta_content {
    width: 100%;
    height: 400px;
    overflow: auto;
    border: 1px solid #c5c5c5;
    border-right: 0;
    font: 14px "Courier New", Courier, monospace;
}
</style>

<div class="page-container">
    <!-- BEGIN SIDEBAR -->
    {include layout/left.html}
    <!-- END SIDEBAR -->
    <!-- BEGIN CONTENT -->
    <div class="page-content-wrapper">
        <div class="page-content">
            <!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->
            <div class="modal fade" id="portlet-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                            <h4 class="modal-title">Modal title</h4>
                        </div>
                        <div class="modal-body">
                            Widget settings form goes here
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn blue">Save changes</button>
                            <button type="button" class="btn default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                    <!-- /.modal-content -->
                </div>
                <!-- /.modal-dialog -->
            </div>
            <!-- /.modal -->
            <!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->
            <!-- BEGIN STYLE CUSTOMIZER -->
            <!-- END STYLE CUSTOMIZER -->
            <!-- BEGIN PAGE HEADER-->
            <h3 class="page-title">
                Edit Document
            </h3>
            <!-- END PAGE HEADER-->
            <!-- BEGIN PAGE CONTENT-->
            <div class="row">
                <div class="col-md-12">
                    <!-- Begin: life time stats -->
                    <div class="portlet">
                    	<br>

                    	<button id='edit_submit' class="btn btn-sm blue filter-cancel"><i class="fa fa-check"></i> 提交修改</button>
                        <br>
                        {if isset($docId)}
                        <div class="row static-info">
                            <div class="col-md-2 name">
                                ID值
                            </div>

                            <div class="col-md-7 value">
                                <input id="docid" type="text" name = "docid" value="{if isset($docId)}{$docId}{/if}" readonly="readonly">
                            </div>
                        </div>
                        {/if}

                        <br>
                        <div class="row static-info">
                            <div class="col-md-2 name">
                                分类
                            </div>

                            <div class="col-md-7 value">
                                <select id="category" class="form-control form-filter input-sm" style="width: 173.33px">
                                    <option value="{if isset($cat)}{$cat['id']}{/if}">{if isset($cat)}{$categoryDesc[$cat['id']]}{else}---所属分类---{/if}</option>
                                    {foreach ($categoryDesc as  $k=>$v)  }
                                    <option value="{$k}">{$v}</option>
                                    {/foreach}
                                </select>

                            </div>
                        </div>
                        <br>
                        <div class="row static-info">
                            <div class="col-md-2 name">
                                文档名称
                            </div>

                            <div class="col-md-7 value">
                                <input name="title" id="txta_title" type="text" value="{if isset($doc)}{$doc['title']}{/if}">
                            </div>
                        </div>
                        <br>
                        <div class="row static-info">
                            <div class="col-md-2 name">
                                排序(从小到大)
                            </div>

                            <div class="col-md-7 value">
                                <input id="sort" type="number" value="{if isset($doc)}{$doc['sort']}{/if}">
                            </div>
                        </div>

                        <br>
                        <br>

                        <div class="row static-info">
                            <div class="col-md-2 name">
                                内容
                            </div>

                            <div class="col-md-7 value">
                            	<!--<textarea name = "content" id="txta_content">{if isset($doc)}{$doc['content']}{/if}</textarea>-->

                                <!--<script type="text/plain" id="myEditor" style="width:1000px;height:240px;">
                                    <p>这里我可以写一些输入提示</p>
                                </script>-->
                                <!--<script type="text/plain" id="myEditor"></script>-->
                                <script type="text/plain" id="myEditor"  style="width:1000px;height:240px;">{$doc['content']}</script>
                            </div>
                        </div>
                        <div class="row static-info">
                            <div class="col-md-2 name">
                                图片
                            </div>
                            <div class="col-md-7 value">
                                {if isset($img_url2)}
                                <div style="width: 180px;height:180px;display:inline-block;">
                                    <img style="width: 180px;height: 160px;" src="{$img_url2}"><br>
                                    <input type="text" style="width: 180px;height: 20px;background-color:lightgrey;" value="{$img_url2}">
                                </div>
                                {else}
                                {/if}
                                {if isset($img_url3)}
                                <div style="width: 180px;height:180px;display:inline-block;">
                                    <img style="width: 180px;height: 160px;" src="{$img_url2}"><br>
                                    <input type="text" style="width: 180px;height: 20px" value="{$img_url3}">
                                    </div>
                                {else}
                                {/if}
                                {if isset($img_url4)}
                                <div style="width: 180px;height:180px;display:inline-block;">
                                    <img style="width: 180px;height: 160px;" src="{$img_url2}"><br>
                                    <input type="text" style="width: 180px;height: 20px;background-color:lightgrey;" value="{$img_url4}">
                                    </div>
                                {else}
                                {/if}
                                {if isset($img_url5)}
                                <div style="width: 180px;height:180px;display:inline-block;">
                                    <img style="width: 180px;height: 160px;" src="{$img_url2}"><br>
                                    <input type="text" style="width: 180px;height: 20px" value="{$img_url5}">
                                    </div>
                                {else}
                                {/if}
                                {if isset($img_url6)}
                                <div style="width: 180px;height:180px;display:inline-block;">
                                    <img style="width: 180px;height: 160px;" src="{$img_url2}"><br>
                                    <input type="text" style="width: 180px;height: 20px;background-color:lightgrey;" value="{$img_url6}">
                                    </div>
                                {else}
                                {/if}
                            </div>
                        </div>


                        <div class="row static-info">
                            <div class="col-md-2 name">

                            </div>
                            <div class="col-md-7 value">
                                {if !isset($img_url2)}
                                <div class="col-md-7 value">
                                    <table>
                                        <tr>
                                            <td><input type="file" name="FileUpload" style="width:200px" id="FileUpload1" /><input id="btn_uploadimg1" type="button" value="点击上传" /></td>
                                            <td><input type="file" name="FileUpload" style="width:200px" id="FileUpload2" /><input id="btn_uploadimg2" type="button" value="点击上传" /></td>
                                            <td><input type="file" name="FileUpload" style="width:200px" id="FileUpload3" /><input id="btn_uploadimg3" type="button" value="点击上传" /></td>
                                            <td><input type="file" name="FileUpload" style="width:200px" id="FileUpload4" /><input id="btn_uploadimg4" type="button" value="点击上传" /></td>
                                            <td><input type="file" name="FileUpload" style="width:200px" id="FileUpload5" /><input id="btn_uploadimg5" type="button" value="点击上传" /></td>
                                        </tr>
                                    </table>
                                </div>
                                {/if}
                            </div>
                        </div>

                    </div>
                    <!-- End: life time stats -->
                </div>
            </div>
            <!-- END PAGE CONTENT-->
        </div>
    </div>
    <!-- END CONTENT -->
    <!-- BEGIN QUICK SIDEBAR -->
    <!-- END QUICK SIDEBAR -->
</div>


<script type="text/javascript">
	$(document).ready(function(){
		$("#edit_submit").click(function(){
            sort = $('#sort').val();
			cat = $("#category").find("option:selected").val();
			title = $("#txta_title").val();
			content = $("#txta_content").val();
            var um = UM.getEditor('myEditor');
            var html = um.getContent();
            console.log(html);
            content = html;
            if (!sort || !cat || !title || !content) {
                alert('请将内容补充完整');
            }

			$.ajax({
		        type: "POST",
		        url: "/content/no/doc/docEditSubmit/",
		        data: {
                    sort:sort,
		        	cat:cat,
		        	title:title,
		        	content:content
		        },
		        dataType:'json',
		        success: function(data){
		        	alert("编辑成功！");
                    window.history.go(-1);
		        }
			});
		});

    });
</script>

<script type="text/javascript">
    $(function () {
        $("#btn_uploadimg1").click(function () {
            var fileObj = document.getElementById("FileUpload1").files[0]; // js 获取文件对象
            console.log(fileObj);
            if (typeof (fileObj) == "undefined" || fileObj.size <= 0) {
                alert("请选择文件");
                return;
            }
            var formFile = new FormData();
            doc_id = $('#docid').val();
            console.log(doc_id);

            formFile.append("action", "UploadVMKImagePath");
            formFile.append("img", fileObj); //加入文件对象
            formFile.append("docid", doc_id); //加入文件对象
            var datas = formFile;

            $.ajax({
                url: "/content/no/doc/updateFile/?doc_id="+doc_id,
                data: datas,
                type: "Post",
                dataType: "json",
                cache: false,//上传文件无需缓存
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                success: function (code) {
                    if(code == 0){
                        alert("上传图片1成功!");
                    }else{
                        alert("上传失败!");
                    }
                },
            })
        })

        $("#btn_uploadimg2").click(function () {
            var fileObj = document.getElementById("FileUpload2").files[0]; // js 获取文件对象
            console.log(fileObj);
            if (typeof (fileObj) == "undefined" || fileObj.size <= 0) {
                alert("请选择文件");
                return;
            }
            var formFile = new FormData();
            doc_id = $('#docid').val();
            console.log(doc_id);

            formFile.append("action", "UploadVMKImagePath");
            formFile.append("img", fileObj); //加入文件对象
            formFile.append("docid", doc_id); //加入文件对象
            var datas = formFile;

            $.ajax({
                url: "/content/no/doc/updateFile/?doc_id="+doc_id,
                data: datas,
                type: "Post",
                dataType: "json",
                cache: false,//上传文件无需缓存
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                success: function (code) {
                    if(code == 0){
                        alert("上传图片2成功!");
                    }else{
                        alert("上传失败!");
                    }
                },
            })
        })

        $("#btn_uploadimg3").click(function () {
            var fileObj = document.getElementById("FileUpload3").files[0]; // js 获取文件对象
            console.log(fileObj);
            if (typeof (fileObj) == "undefined" || fileObj.size <= 0) {
                alert("请选择文件");
                return;
            }
            var formFile = new FormData();
            doc_id = $('#docid').val();
            console.log(doc_id);

            formFile.append("action", "UploadVMKImagePath");
            formFile.append("img", fileObj); //加入文件对象
            formFile.append("docid", doc_id); //加入文件对象
            var datas = formFile;

            $.ajax({
                url: "/content/no/doc/updateFile/?doc_id="+doc_id,
                data: datas,
                type: "Post",
                dataType: "json",
                cache: false,//上传文件无需缓存
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                success: function (code) {
                    if(code == 0){
                        alert("上传图片3成功!");
                    }else{
                        alert("上传失败!");
                    }
                },
            })
        })

        $("#btn_uploadimg4").click(function () {
            var fileObj = document.getElementById("FileUpload3").files[0]; // js 获取文件对象
            console.log(fileObj);
            if (typeof (fileObj) == "undefined" || fileObj.size <= 0) {
                alert("请选择文件");
                return;
            }
            var formFile = new FormData();
            doc_id = $('#docid').val();
            console.log(doc_id);

            formFile.append("action", "UploadVMKImagePath");
            formFile.append("img", fileObj); //加入文件对象
            formFile.append("docid", doc_id); //加入文件对象
            var datas = formFile;

            $.ajax({
                url: "/content/no/doc/updateFile/?doc_id="+doc_id,
                data: datas,
                type: "Post",
                dataType: "json",
                cache: false,//上传文件无需缓存
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                success: function (code) {
                    if(code == 0){
                        alert("上传图片4成功!");
                    }else{
                        alert("上传失败!");
                    }
                },
            })
        })

        $("#btn_uploadimg5").click(function () {
            var fileObj = document.getElementById("FileUpload3").files[0]; // js 获取文件对象
            console.log(fileObj);
            if (typeof (fileObj) == "undefined" || fileObj.size <= 0) {
                alert("请选择文件");
                return;
            }
            var formFile = new FormData();
            doc_id = $('#docid').val();
            console.log(doc_id);

            formFile.append("action", "UploadVMKImagePath");
            formFile.append("img", fileObj); //加入文件对象
            formFile.append("docid", doc_id); //加入文件对象
            var datas = formFile;

            $.ajax({
                url: "/content/no/doc/updateFile/?doc_id="+doc_id,
                data: datas,
                type: "Post",
                dataType: "json",
                cache: false,//上传文件无需缓存
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                success: function (code) {
                    if(code == 0){
                        alert("上传图片5成功!");
                    }else{
                        alert("上传失败!");
                    }
                },
            })
        })



    })
</script>
<script src="{CONST|H_STATIC_URL}assets/global/plugins/umeditor/src1/src2/umeditor.config.js" type="text/javascript"></script>
<script src="{CONST|H_STATIC_URL}assets/global/plugins/umeditor/src1/src2/umeditor.min.js" type="text/javascript"></script>
<script src="{CONST|H_STATIC_URL}assets/global/plugins/umeditor/src1/src2/lang/zh-cn/zh-cn.js" type="text/javascript"></script>
<script type="text/javascript">
    //实例化编辑器
    var um = UM.getEditor('myEditor');
</script>





